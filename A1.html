<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>è‡ªåŠ©ç»“è´¦å®éªŒ Aï¼ˆé«˜å¯¹æ¯” + é«˜ä¿¡æ¯å¯†åº¦ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <!-- React & ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel for in-browser JSX transform -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: #0f172a;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      /* é€‚é… iPhone åˆ˜æµ· / åº•éƒ¨ Home æ¡ï¼›åœ¨ Android / æ™®é€šæµè§ˆå™¨é‡Œ env() = 0 */
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
    }
  </style>
</head>
<body>
  <div id="root"></div>

<script type="text/babel">

/* -------------------------
   æ•°æ®
------------------------- */
const ITEMS = [
  {
    id: 1,
    name: "æœ‰æœºå…¨è„‚çº¯ç‰›å¥¶ (1L)",
    price: 18.5,
    status: "normal",
    icon: "ğŸ¥›",
    origin: "å†…è’™å¤ç‰§åœº",
    shelf: "å†·è—åŒº A3",
    expireHint: "ä¿è´¨æœŸ 15 å¤©",
    extraTag: "æœ‰æœºè®¤è¯",
    confusingTag: "ä¸´äº«"
  },
  {
    id: 2,
    name: "å…¨éº¦åˆ‡ç‰‡é¢åŒ…",
    price: 6.8,
    status: "expiring",
    icon: "ğŸ",
    origin: "åº—å†…çƒ˜ç„™æˆ¿",
    shelf: "é¢åŒ…æŸœ B2",
    expireHint: "æ˜æ—¥åˆ°æœŸ",
    extraTag: null,
    confusingTag: null
  },
  {
    id: 3,
    name: "ä½è„‚è‰è“é…¸å¥¶ (4Ã—100g)",
    price: 12.9,
    status: "expiring",
    icon: "ğŸ“",
    origin: "æ²³åŒ—ä¿å®šå·¥å‚",
    shelf: "å†·è—åŒº A1",
    expireHint: "ä¿è´¨æœŸå‰© 2 å¤©",
    extraTag: "å®¶åº­è£…",
    confusingTag: null
  },
  {
    id: 4,
    name: "åŸå‘³è‹æ‰“é¥¼å¹²",
    price: 8.5,
    status: "normal",
    icon: "ğŸª",
    origin: "å¹¿ä¸œä¼‘é—²é£Ÿå“åŒº",
    shelf: "è´§æ¶ C5",
    expireHint: "ä¿è´¨æœŸ 90 å¤©",
    extraTag: "æ–°å“ä¸Šå¸‚",
    confusingTag: "ä¸´è"
  },
  {
    id: 5,
    name: "è¿›å£é»‘å·§å…‹åŠ› 72%",
    price: 28.0,
    status: "expiring",
    icon: "ğŸ«",
    origin: "æ¯”åˆ©æ—¶è¿›å£åŒº",
    shelf: "è´§æ¶ D1",
    expireHint: "èµå‘³æœŸä¸´è¿‘",
    extraTag: null,
    confusingTag: null
  }
];

/* -------------------------
   ä¸»é¢˜
------------------------- */
const THEME = {
  highContrast: {
    appBg: "#ffffff",
    frameBorder: "#000000",
    headerBg: "#111827",
    headerText: "#ffffff",
    headerBorder: "#000000",
    taskBg: "#ffeb3b",
    taskBorder: "#000000",
    taskText: "#000000",
    listCardBorder: "#000000",
    listCardShadow: "4px 4px 0 #000000",
    nameText: "#000000",
    metaText: "#111827",
    priceText: "#000000",
    expTagBg: "#ff0000",
    expTagBorder: "2px solid #000000",
    expTagText: "#ffffff",
    normalTagBg: "#ffffff",
    normalTagBorder: "1px solid #000000",
    normalTagText: "#111827",
    deleteBg: "#dc2626",
    deleteText: "#ffffff",
    deleteBorder: "2px solid #000000",
    confirmBg: "#16a34a",
    confirmBorder: "2px solid #000000"
  }
};

/* -------------------------
   ä¸»ç»„ä»¶ App
------------------------- */
function App() {
  const [items, setItems] = React.useState(ITEMS);
  const [errorDeleteCount, setErrorDeleteCount] = React.useState(0);
  const [hasStarted, setHasStarted] = React.useState(false);
  const [resultData, setResultData] = React.useState(null);
  const startTimeRef = React.useRef(null);

  const theme = THEME.highContrast;

  const handleDelete = (id) => {
    setItems(prev => {
      const target = prev.find(i => i.id === id);
      if (target && target.status === "normal") {
        setErrorDeleteCount(c => c + 1);
      }
      return prev.filter(i => i.id !== id);
    });
  };

  const handleConfirm = () => {
    const endTime = Date.now();
    const startTime = startTimeRef.current ?? endTime;
    const duration = ((endTime - startTime) / 1000).toFixed(2);
    const remainingExp = items.filter(i => i.status === "expiring").length;

    setResultData({
      duration,
      errorDeleteCount,
      remainingExp
    });
  };

  const handleStart = () => {
    setHasStarted(true);
    startTimeRef.current = Date.now();
  };

  const totalPrice = items
    .reduce((sum, i) => sum + i.price, 0)
    .toFixed(2);

  const showMeta = true;
  const showSecondaryTags = true;
  const showAdBanner = true;

  return (
    <div
      style={{
        display: "flex",
        flexDirection: "column",
        /* å…³é”®ï¼šå®¹å™¨é«˜åº¦å›ºå®šä¸ºè§†å£é«˜åº¦å‡å»å®‰å…¨åŒºï¼Œåˆ—è¡¨é«˜åº¦éšä¹‹å›ºå®š */
        height: "calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom))",
        minHeight: "calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom))",
        maxWidth: 480,
        margin: "0 auto",
        borderLeft: "1px solid #000",
        borderRight: "1px solid #000",
        backgroundColor: theme.appBg,
        position: "relative"
      }}
    >
      {/* é¡¶éƒ¨å¯¼èˆª */}
      <header
        style={{
          display: "flex",
          alignItems: "center",
          justifyContent: "space-between",
          padding: "12px 16px",
          backgroundColor: theme.headerBg,
          color: theme.headerText,
          borderBottom: "2px solid " + theme.headerBorder
        }}
      >
        <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
          <div
            style={{
              width: 26,
              height: 26,
              borderRadius: "999px",
              border: "2px solid #fff",
              display: "flex",
              alignItems: "center",
              justifyContent: "center"
            }}
          >
            â†
          </div>
          <div>
            <div style={{ fontSize: 20, fontWeight: 900 }}>è‡ªåŠ©ç»“è´¦</div>
            <div style={{ fontSize: 11, opacity: 0.7 }}>
              è¯·æ ¸å¯¹è´­ç‰©æ¸…å•åå†æ”¯ä»˜
            </div>
          </div>
        </div>

        <div
          style={{
            width: 22,
            height: 22,
            borderRadius: "999px",
            border: "2px solid #fff",
            display: "flex",
            alignItems: "center",
            justifyContent: "center"
          }}
        >
          ?
        </div>
      </header>

      {/* ä»»åŠ¡æ¡ */}
      <section
        style={{
          padding: "8px 14px",
          backgroundColor: theme.taskBg,
          borderBottom: "1px solid " + theme.taskBorder,
          display: "flex",
          gap: 8,
          fontSize: 13
        }}
      >
        <b>i</b>
        è¯·åˆ é™¤æ‰€æœ‰æ ‡è®°ä¸ºâ€œä¸´æœŸâ€çš„å•†å“ï¼Œç„¶åç‚¹å‡»â€œç¡®è®¤ç»“è´¦â€
      </section>

      {/* å¹¿å‘Šæ¡ */}
      {showAdBanner && (
        <div style={{ padding: "10px 14px 0" }}>
          <div
            style={{
              padding: "6px 8px",
              borderRadius: 8,
              border: "2px dashed #facc15",
              background: "#000",
              color: "#fff",
              fontSize: 12,
              display: "flex",
              justifyContent: "space-between"
            }}
          >
            ğŸ ä¼šå‘˜ä¼˜æƒ ï¼šæœ¬æ¬¡ç»“è´¦æ»¡ 100 å…ƒç«‹å‡ 20 å…ƒ
            <span style={{ opacity: 0.6 }}>Ã—</span>
          </div>
        </div>
      )}

      {/* åˆ—è¡¨åŒºåŸŸ â€”â€” é«˜åº¦ç”±å¤–å±‚ flex æ’‘æ»¡ï¼Œå§‹ç»ˆå›ºå®šï¼Œå¯æ»‘åŠ¨ */}
      <main
        style={{
          flex: 1,
          minHeight: 0,             // å…³é”®ï¼šå…è®¸å†…å®¹åœ¨ flex é‡Œæ»šåŠ¨
          overflowY: "auto",
          padding: "8px 10px"
        }}
      >
        {items.map(item => (
          <article
            key={item.id}
            style={{
              marginBottom: 8,
              padding: 10,
              backgroundColor: "#fff",
              borderRadius: 8,
              display: "flex",
              gap: 10,
              border: "1px solid #000",
              boxShadow: theme.listCardShadow
            }}
          >
            {/* å›¾ç‰‡åŒºåŸŸ */}
            <div
              style={{
                width: 52,
                height: 52,
                backgroundColor: "#f9fafb",
                borderRadius: 10,
                border: "2px solid #000",
                display: "flex",
                alignItems: "center",
                justifyContent: "center"
              }}
            >
              <span style={{ fontSize: 28 }}>{item.icon}</span>
            </div>

            {/* æ–‡æœ¬ */}
            <div style={{ flex: 1 }}>
              <div style={{ display: "flex", justifyContent: "space-between" }}>
                <h2 style={{ margin: 0, fontSize: 15, fontWeight: 900 }}>
                  {item.name}
                </h2>
                <span style={{ fontSize: 15, fontWeight: 800 }}>
                  Â¥{item.price.toFixed(1)}
                </span>
              </div>

              {showMeta && (
                <div style={{ fontSize: 11, marginTop: 2 }}>
                  <div>ä½ç½®ï¼š{item.shelf}</div>
                  <div>äº§åœ°ï¼š{item.origin}</div>
                  <div>ç³»ç»Ÿæç¤ºï¼š{item.expireHint}</div>
                </div>
              )}

              {/* æ ‡ç­¾ + åˆ é™¤æŒ‰é’® */}
              <div
                style={{
                  marginTop: 6,
                  display: "flex",
                  justifyContent: "space-between",
                  alignItems: "center"
                }}
              >
                <div style={{ display: "flex", gap: 4, flexWrap: "wrap" }}>
                  {item.status === "expiring" && (
                    <span
                      style={{
                        padding: "2px 8px",
                        backgroundColor: theme.expTagBg,
                        border: theme.expTagBorder,
                        color: "#fff",
                        borderRadius: 999,
                        fontSize: 11,
                        fontWeight: 700
                      }}
                    >
                      âš  ä¸´æœŸ
                    </span>
                  )}

                  {showSecondaryTags && item.extraTag && (
                    <span
                      style={{
                        padding: "2px 8px",
                        backgroundColor: "#fff",
                        border: theme.normalTagBorder,
                        borderRadius: 999,
                        fontSize: 11
                      }}
                    >
                      ğŸ· {item.extraTag}
                    </span>
                  )}
                </div>

                <button
                  onClick={() => handleDelete(item.id)}
                  style={{
                    padding: "4px 10px",
                    borderRadius: 999,
                    backgroundColor: theme.deleteBg,
                    border: theme.deleteBorder,
                    color: "#fff",
                    cursor: "pointer",
                    fontSize: 11,
                    fontWeight: 600
                  }}
                >
                  ğŸ—‘ åˆ é™¤
                </button>
              </div>
            </div>
          </article>
        ))}
      </main>

      {/* åº•éƒ¨æŒ‰é’® */}
      <footer
        style={{
          padding: "8px 14px 12px",
          borderTop: "1px solid #000",
          paddingBottom: "calc(12px + env(safe-area-inset-bottom))" // æŒ‰é’®ä¸Šé¢ç•™å‡ºåº•éƒ¨å®‰å…¨åŒº
        }}
      >
        <button
          onClick={handleConfirm}
          style={{
            width: "100%",
            padding: "10px 14px",
            backgroundColor: theme.confirmBg,
            border: theme.confirmBorder,
            borderRadius: 999,
            color: "#fff",
            fontWeight: 700,
            fontSize: 15,
            cursor: "pointer",
            display: "flex",
            justifyContent: "space-between"
          }}
        >
          <span>ç¡®è®¤ç»“è´¦</span>
          <span>å…± Â¥{totalPrice}</span>
        </button>
      </footer>

      {/* å¼€å§‹æµ‹è¯•æµ®çª— */}
      {!hasStarted && (
        <div
          style={{
            position: "absolute",
            inset: 0,
            backgroundColor: "rgba(15,23,42,0.55)",
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
            zIndex: 99
          }}
        >
          <div
            style={{
              width: "88%",
              maxWidth: 360,
              padding: "20px",
              backgroundColor: "#fff",
              borderRadius: 18,
              boxShadow: "0 18px 40px rgba(0,0,0,0.4)"
            }}
          >
            <div style={{ fontSize: 16, fontWeight: 800, marginBottom: 10 }}>
              æµ‹è¯•è¯´æ˜
            </div>
            <div style={{ fontSize: 13, color: "#4b5563", lineHeight: 1.6 }}>
              ä»»åŠ¡ï¼š
              <br />1. åˆ é™¤æ‰€æœ‰æ ‡è®°ä¸ºâ€œä¸´æœŸâ€çš„å•†å“ï¼›
              <br />2. ç„¶åç‚¹å‡»åº•éƒ¨çš„â€œç¡®è®¤ç»“è´¦â€æŒ‰é’®ã€‚
              <br />
              <span style={{ color: "#dc2626", fontWeight: 700 }}>
                3. è¯·å®Œæˆä½“éªŒåå°†æ•°æ®æˆªå›¾ï¼Œä¸Šä¼ è‡³é—®å·æ˜Ÿã€‚
              </span>
            </div>

            <button
              onClick={handleStart}
              style={{
                marginTop: 16,
                width: "100%",
                padding: "10px",
                borderRadius: 999,
                backgroundColor: "#2563eb",
                color: "#fff",
                fontWeight: 700,
                fontSize: 14,
                cursor: "pointer",
                border: "none"
              }}
            >
              ç¡®è®¤å¹¶å¼€å§‹æµ‹è¯•
            </button>
          </div>
        </div>
      )}

      {/* ç»“æœç™½è‰²å¼¹çª— */}
      {resultData && (
        <div
          style={{
            position: "absolute",
            inset: 0,
            backgroundColor: "rgba(0,0,0,0.45)",
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
            zIndex: 100
          }}
        >
          <div
            style={{
              width: "88%",
              maxWidth: 380,
              backgroundColor: "#ffffff",
              borderRadius: 28,
              padding: 24,
              boxShadow: "0 20px 40px rgba(0,0,0,0.45)"
            }}
          >
            <div
              style={{
                fontSize: 20,
                fontWeight: 800,
                marginBottom: 18
              }}
            >
              æ­¤é¡µé¢æ˜¾ç¤º
            </div>

            <div
              style={{
                fontSize: 15,
                lineHeight: 1.8,
                marginBottom: 12
              }}
            >
              <div>å®Œæˆæ—¶é—´ï¼š{resultData.duration} ç§’</div>
              <div>è¯¯åˆ æ¬¡æ•°ï¼š{resultData.errorDeleteCount}</div>
              <div>å‰©ä½™ä¸´æœŸå•†å“æ•°ï¼š{resultData.remainingExp}</div>
            </div>

            <div
              style={{
                fontSize: 15,
                fontWeight: 700,
                color: "#d60000",
                marginBottom: 20
              }}
            >
              è¯·å°†æ­¤æ•°æ®æˆªå›¾ä¸Šä¼ è‡³é—®å·æ˜Ÿã€‚
            </div>

            <button
              onClick={() => setResultData(null)}
              style={{
                width: "100%",
                padding: "12px",
                borderRadius: 999,
                backgroundColor: "#2563eb",
                color: "#ffffff",
                border: "none",
                fontSize: 16,
                fontWeight: 700,
                cursor: "pointer"
              }}
            >
              ç¡®å®š
            </button>
          </div>
        </div>
      )}

    </div>
  );
}

/* -------------------------
   Rootï¼šç›´æ¥æ¸²æŸ“ Condition A
------------------------- */
function Root() {
  return <App />;
}

ReactDOM.createRoot(document.getElementById("root")).render(<Root />);
</script>
</body>
</html>